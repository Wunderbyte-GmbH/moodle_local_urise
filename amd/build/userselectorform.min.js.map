{"version":3,"file":"userselectorform.min.js","sources":["../src/userselectorform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/*\n * @package    local_urise\n * @author     Bernhard Fischer\n * @copyright  2024 Wunderbyte GmbH <info@wunderbyte.at>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Modal form to manage booking option tags (botags).\n *\n * @module     local_urise\n * @copyright  2024 Wunderbyte GmbH\n * @author     Georg MaiÃŸer\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport DynamicForm from 'core_form/dynamicform';\n\nconst SELECTORS = {\n    USERSELECTORFORM: '[data-id=\"urise-selectuserformcontainer\"]',\n};\n\n/**\n * Init the user selector form.\n *\n */\nexport function init() {\n\n    const element = document.querySelector(SELECTORS.USERSELECTORFORM);\n\n    // Initialize the form.\n    const dynamicForm = new DynamicForm(\n        element,\n        'local_shopping_cart\\\\form\\\\dynamic_select_users'\n    );\n\n    // When form is submitted - remove it from DOM:\n    dynamicForm.addEventListener(dynamicForm.events.FORM_SUBMITTED, e => {\n        const response = e.detail;\n\n        if (response.redirecturl) {\n\n            // We use the class from shopping cart, so we need to change the url here.\n            let url = new URL(response.redirecturl);\n\n            // Extract the search parameters (query string)\n            let params = url.search;\n\n            // Base URL\n            let baseUrl = '/local/urise/meinekurse.php';\n\n            // Append the parameters to the base URL\n            let newUrl = baseUrl + params;\n\n            location.href = newUrl;\n        } else {\n            dynamicForm.load();\n        }\n    });\n\n    dynamicForm.load();\n}\n"],"names":["element","document","querySelector","SELECTORS","dynamicForm","DynamicForm","addEventListener","events","FORM_SUBMITTED","e","response","detail","redirecturl","newUrl","URL","search","location","href","load"],"mappings":";;;;;;;;;;;;;;4FA2CUA,QAAUC,SAASC,cAAcC,4BAGjCC,YAAc,IAAIC,qBACpBL,QACA,mDAIJI,YAAYE,iBAAiBF,YAAYG,OAAOC,gBAAgBC,UACtDC,SAAWD,EAAEE,UAEfD,SAASE,YAAa,KAYlBC,OAHU,8BANJ,IAAIC,IAAIJ,SAASE,aAGVG,OAQjBC,SAASC,KAAOJ,YAEhBT,YAAYc,UAIpBd,YAAYc,gFA1CVf,2BACgB"}